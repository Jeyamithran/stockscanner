<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Box Scanner | Pro Trader Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --font-family-primary: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

            --bs-body-bg: #0d1117;
            --bs-body-color: #f0f6fc;
            --bs-card-bg: #161b22;
            --bs-border-color: #30363d;
            --bs-primary: #58a6ff;
            --text-data: #6fbbd3;
            --text-gain: #34d058;
            --text-muted-enhanced: #8b949e;
        }

        body.light-mode {
            --bs-body-bg: #f5f5f5;
            --bs-body-color: #333;
            --bs-card-bg: #ffffff;
            --bs-border-color: #ccc;
            --text-data: #007bff;
            --text-gain: #28a745;
            --text-muted-enhanced: #666;
        }

        body {
            background-color: var(--bs-body-bg);
            color: var(--bs-body-color);
            font-family: var(--font-family-primary);
            transition: all 0.3s;
            font-size: 14px;
        }

        body.font-small { font-size: 12px; }
        body.font-large { font-size: 16px; }

        .dashboard-header {
            border-bottom: 2px solid var(--bs-border-color);
            padding-bottom: 15px;
            margin-bottom: 10px;
        }

        .dashboard-header .lead {
            color: var(--text-muted-enhanced) !important;
            font-weight: 500;
        }

        .card {
            background-color: var(--bs-card-bg);
            border: 1px solid var(--bs-border-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }

        .table-dark thead th, .table-dark {
            border-color: var(--bs-border-color);
        }

        .table-dark tbody tr:hover {
            background-color: #21262d;
            cursor: pointer;
        }

        .text-ticker { color: var(--text-data); font-weight: 600; }
        .text-gain-percent { color: var(--text-gain); font-weight: 600; }
        .text-muted { color: var(--text-muted-enhanced) !important; }

        /* Scrollable news lists */
        .news-list-scroll {
            max-height: 350px;
            overflow-y: auto;
        }

        @media (max-width: 992px) {
            .dashboard-header { text-align: left !important; }
            .dashboard-header h1 { font-size: 1.8rem; }
            .col-lg-4 { padding-bottom: 20px; }
        }
    </style>
</head>
<body class="dark-mode">

<div class="container-fluid p-3 p-md-4">
    <div class="dashboard-header d-flex justify-content-between align-items-center flex-wrap">
        <div>
            <h1 class="text-info mb-0">
                Black Box Scanner <span class="badge bg-danger">PRO LIVE</span>
            </h1>
            <p class="lead small mt-1 mb-0 d-none d-md-block">
                High-Velocity Breakout Scanner with AI-Enhanced News.
            </p>
        </div>

        <div class="d-flex gap-3 align-items-center mt-2 mt-md-0">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="themeSwitch" checked>
                <label class="form-check-label" for="themeSwitch">Dark Mode</label>
            </div>
            <select id="fontSizeSelect"
                    class="form-select form-select-sm bg-dark text-white"
                    style="width: 120px;">
                <option value="font-small">Small Font</option>
                <option value="" selected>Medium Font</option>
                <option value="font-large">Large Font</option>
            </select>
            <button id="runScanBtn" class="btn btn-primary btn-sm px-4">
                Run Scanner
            </button>
        </div>
    </div>

    <p class="small text-muted mb-2" id="lastUpdated">Last Scan: Never</p>

    <!-- MAIN TABS -->
    <ul class="nav nav-tabs mt-2" id="mainTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active"
                    id="news-tab-btn"
                    data-bs-toggle="tab"
                    data-bs-target="#news-tab"
                    type="button"
                    role="tab">
                News Feed
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link"
                    id="scanner-tab-btn"
                    data-bs-toggle="tab"
                    data-bs-target="#scanner-tab"
                    type="button"
                    role="tab">
                Black Box Scanner
            </button>
        </li>
    </ul>

    <div class="tab-content mt-3">
        <!-- NEWS TAB -->
        <div class="tab-pane fade show active"
             id="news-tab"
             role="tabpanel"
             aria-labelledby="news-tab-btn">

            <!-- Global refresh for ALL news -->
            <div class="d-flex justify-content-end mb-2">
                <button id="newsRefreshBtn" class="btn btn-sm btn-outline-light">
                    Refresh All News
                </button>
            </div>

            <!-- Top row: 3 cards (1: stock-specific, 2: Benzinga, 3: Finnhub) -->
            <div class="row">
                <!-- Stock-specific card (1st) -->
                <div class="col-lg-4 col-md-12 col-sm-12 mb-3">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">Stock-Specific Headlines</h5>
                        </div>
                        <div class="card-body p-0">
                            <p class="small text-muted px-3 pt-2 mb-1" id="newsStatusStock">
                                Headlines that mention specific tickers (e.g. HIMS, NVDA, JNJ).
                            </p>
                            <div class="news-list-scroll">
                                <ul class="list-group list-group-flush" id="newsListStock"></ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Benzinga card (2nd) -->
                <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0">Benzinga â€“ News Feed</h5>
                        </div>
                        <div class="card-body p-0">
                            <p class="small text-muted px-3 pt-2 mb-1" id="newsStatusBenzinga">
                                Waiting for headlines...
                            </p>
                            <div class="news-list-scroll">
                                <ul class="list-group list-group-flush" id="newsListBenzinga"></ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Finnhub card (3rd) -->
                <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                    <div class="card">
                        <div class="card-header bg-info text-dark">
                            <h5 class="mb-0">Finnhub â€“ General News</h5>
                        </div>
                        <div class="card-body p-0">
                            <p class="small text-muted px-3 pt-2 mb-1" id="newsStatusFinnhub">
                                Loading news...
                            </p>
                            <div class="news-list-scroll">
                                <ul class="list-group list-group-flush" id="newsListFinnhub"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI View -->
            <div class="row mt-2">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-dark text-white">
                            <h5 class="mb-0">AI View / Analyst Lens</h5>
                        </div>
                        <div class="card-body" id="newsAnalysisPanel">
                            <p class="text-muted mb-0">
                                Select any headline in the lists above and click
                                <strong>AI Detail</strong> to see a short summary,
                                stance (bullish / bearish / mixed / neutral) and risks.
                                This is not investment advice.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div> <!-- /news-tab -->

        <!-- SCANNER TAB -->
        <div class="tab-pane fade"
             id="scanner-tab"
             role="tabpanel"
             aria-labelledby="scanner-tab-btn">

            <div id="scanner-alerts" class="row">
                <div class="col-lg-4 col-sm-12">
                    <div class="card">
                        <div class="card-header bg-danger text-white">
                            <h5>ðŸ”¥ Small Cap / High Beta</h5>
                        </div>
                        <div class="card-body p-0">
                            <table class="table table-dark table-striped table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Ticker</th>
                                        <th>Entry</th>
                                        <th>Target (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="SmallCap-table">
                                    <tr>
                                        <td colspan="3" class="text-center text-muted">
                                            Awaiting Scan Data...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-12">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h5>ðŸŸ¡ Mid Cap / Liquidity Mix</h5>
                        </div>
                        <div class="card-body p-0">
                            <table class="table table-dark table-striped table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Ticker</th>
                                        <th>Entry</th>
                                        <th>Target (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="MidCap-table">
                                    <tr>
                                        <td colspan="3" class="text-center text-muted">
                                            Awaiting Scan Data...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-12">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5>ðŸŸ¢ Large Cap / Institutional</h5>
                        </div>
                        <div class="card-body p-0">
                            <table class="table table-dark table-striped table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Ticker</th>
                                        <th>Entry</th>
                                        <th>Target (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="LargeCap-table">
                                    <tr>
                                        <td colspan="3" class="text-center text-muted">
                                            Awaiting Scan Data...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed analysis card -->
            <div class="row mt-3">
                <div class="col-12">
                    <div class="card">
                        <div id="detailedAnalysisCard" class="p-4">
                            <p class="text-center text-muted mb-0">
                                Click on any alert in the tables above to view the detailed analysis card and trading plan.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div> <!-- /scanner-tab -->
    </div> <!-- /tab-content -->
</div> <!-- /container -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const MARKET_CAPS = ['SmallCap', 'MidCap', 'LargeCap'];
    const runScanBtn = document.getElementById('runScanBtn');
    const lastUpdated = document.getElementById('lastUpdated');
    const fontSizeSelect = document.getElementById('fontSizeSelect');
    const themeSwitch = document.getElementById('themeSwitch');

    let allAlertData = {};
    let currentActiveRow = null;

    // NEWS STATE
    let latestNews = [];
    let newsById = {};

    const newsListFinnhub = document.getElementById('newsListFinnhub');
    const newsListBenzinga = document.getElementById('newsListBenzinga');
    const newsListStock = document.getElementById('newsListStock');

    const newsStatusFinnhub = document.getElementById('newsStatusFinnhub');
    const newsStatusBenzinga = document.getElementById('newsStatusBenzinga');
    const newsStatusStock = document.getElementById('newsStatusStock');
    const newsAnalysisPanel = document.getElementById('newsAnalysisPanel');
    const newsRefreshBtn = document.getElementById('newsRefreshBtn');

    // THEME + FONT
    function applyTheme(isDark) {
        document.body.classList.toggle('light-mode', !isDark);
        document.body.classList.toggle('dark-mode', isDark);
        localStorage.setItem('theme', isDark ? 'dark' : 'light');

        const element = fontSizeSelect;
        const darkClasses = 'bg-dark text-white';
        const lightClasses = 'bg-light text-dark';
        const allThemeClasses = (darkClasses + ' ' + lightClasses).split(' ');
        element.classList.remove(...allThemeClasses);
        if (isDark) {
            element.classList.add(...darkClasses.split(' '));
        } else {
            element.classList.add(...lightClasses.split(' '));
        }
    }

    function applyFontSize(sizeClass) {
        document.body.className = document.body.className.replace(/\bfont-(small|large)\b/g, '');
        if (sizeClass) {
            document.body.classList.add(sizeClass);
        }
        localStorage.setItem('fontSize', sizeClass);
    }

    const savedTheme = localStorage.getItem('theme') || 'dark';
    const savedFontSize = localStorage.getItem('fontSize') || '';

    if (savedTheme === 'light') {
        themeSwitch.checked = false;
        applyTheme(false);
    } else {
        themeSwitch.checked = true;
        applyTheme(true);
    }

    applyFontSize(savedFontSize);
    fontSizeSelect.value = savedFontSize;

    themeSwitch.addEventListener('change', () => applyTheme(themeSwitch.checked));
    fontSizeSelect.addEventListener('change', (e) => applyFontSize(e.target.value));

    // --- HELPER: classify source robustly ---
    function classifySource(item) {
        const src = (item.source || '').toLowerCase();
        const provider = (item.provider || '').toLowerCase();
        const url = (item.url || '').toLowerCase();

        if (src.includes('benzinga') || provider.includes('benzinga') || url.includes('benzinga.com')) {
            return 'benzinga';
        }
        if (src.includes('finnhub')) {
            return 'finnhub';
        }
        // fall back: if provider looks like CNBC, MarketWatch etc, we'll treat as Finnhub general
        if (provider) return 'finnhub';
        return 'unknown';
    }

    // NEWS FUNCTIONS
    async function fetchNewsHeadlines() {
        if (newsStatusStock) newsStatusStock.textContent = 'Loading latest headlines...';
        if (newsStatusBenzinga) newsStatusBenzinga.textContent = 'Waiting for headlines...';
        if (newsStatusFinnhub) newsStatusFinnhub.textContent = 'Loading news...';

        try {
            const res = await fetch('/api/news/headlines?limit=50');
            const json = await res.json();
            console.log('NEWS JSON:', json);  // debug in browser console

            if (!json.success) {
                throw new Error(json.error || 'News API error');
            }

            latestNews = json.data || [];
            newsById = {};
            latestNews.forEach(item => {
                if (item.id) {
                    newsById[item.id] = item;
                }
            });

            renderAllNewsCards();
        } catch (err) {
            console.error('News fetch error', err);
            if (newsStatusStock) {
                newsStatusStock.textContent = 'Failed to load news. Try again later.';
            }
        }
    }

    function renderAllNewsCards() {
        const finnhubItems  = latestNews.filter(n => classifySource(n) === 'finnhub');
        const benzingaItems = latestNews.filter(n => classifySource(n) === 'benzinga');
        const stockItems    = latestNews.filter(
            n => Array.isArray(n.tickers) && n.tickers.length > 0
        );

        renderNewsListToElement(stockItems, newsListStock, newsStatusStock, 'No stock-specific headlines detected yet.');
        renderNewsListToElement(benzingaItems, newsListBenzinga, newsStatusBenzinga, 'No Benzinga headlines.');
        renderNewsListToElement(finnhubItems, newsListFinnhub, newsStatusFinnhub, 'No Finnhub headlines.');
    }

    function renderNewsListToElement(items, ulEl, statusEl, emptyText) {
        if (!ulEl) return;
        ulEl.innerHTML = '';
        if (!items.length) {
            if (statusEl) statusEl.textContent = emptyText;
            return;
        }
        if (statusEl) statusEl.textContent = '';

        items.forEach(item => {
            const li = document.createElement('li');
            li.className = 'list-group-item d-flex flex-column flex-md-row justify-content-between align-items-start gap-2';

            const dt = new Date((item.published_ts || 0) * 1000);
            const timeStr = isNaN(dt.getTime()) ? '' : dt.toLocaleString();

            const tickerText = (item.tickers && item.tickers.length)
                ? item.tickers.slice(0, 4).join(', ')
                : '';

            const classified = classifySource(item);
            const isBenzinga = classified === 'benzinga';

            li.innerHTML = `
                <div class="flex-grow-1">
                    <div class="d-flex align-items-center mb-1">
                        <span class="badge ${isBenzinga ? 'bg-warning text-dark' : 'bg-secondary'} me-2">
                            ${item.source || item.provider || 'News'}
                        </span>
                        ${tickerText ? `<span class="badge border border-light text-muted">${tickerText}</span>` : ''}
                    </div>
                    <a href="${item.url || '#'}" target="_blank" class="fw-semibold text-decoration-none">
                        ${item.headline}
                    </a>
                    <div class="small text-muted mt-1">${timeStr}</div>
                </div>
                <div class="d-flex flex-column align-items-end">
                    <button class="btn btn-sm btn-outline-info mb-1" data-id="${item.id}">
                        AI Detail
                    </button>
                </div>
            `;

            const btn = li.querySelector('button');
            btn.addEventListener('click', () => {
                handleNewsDetailClick(item.id);
            });

            ulEl.appendChild(li);
        });
    }

    async function handleNewsDetailClick(articleId) {
        const article = newsById[articleId];
        if (!article || !newsAnalysisPanel) return;

        newsAnalysisPanel.innerHTML = `
            <p class="text-muted mb-2">Thinking like a pro analystâ€¦</p>
            <div class="spinner-border spinner-border-sm" role="status"></div>
        `;

        try {
            const res = await fetch('/api/news/analysis', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    symbol: (article.tickers && article.tickers[0]) || null,
                    article: article
                })
            });
            const json = await res.json();
            if (!json.success) {
                throw new Error(json.error || 'AI analysis failed');
            }
            const data = json.data;
            renderNewsAnalysis(article, data);
        } catch (err) {
            console.error('AI analysis error', err);
            newsAnalysisPanel.innerHTML = `
                <p class="text-danger mb-0">AI analysis failed. Please try again later.</p>
            `;
        }
    }

    function renderNewsAnalysis(article, analysis) {
        if (!newsAnalysisPanel) return;
        const stance = (analysis.stance || 'neutral').toLowerCase();
        let badgeClass = 'bg-secondary';
        if (stance === 'bullish') badgeClass = 'bg-success';
        else if (stance === 'bearish') badgeClass = 'bg-danger';
        else if (stance === 'mixed') badgeClass = 'bg-warning text-dark';

        const rationaleList = (analysis.rationale || [])
            .map(p => `<li>${p}</li>`)
            .join('');

        newsAnalysisPanel.innerHTML = `
            <h6 class="text-info mb-1">${article.headline}</h6>
            <p class="small text-muted mb-2">
                Source: ${article.source || article.provider || 'News'}
                ${article.tickers && article.tickers.length ? ` | Tickers: ${article.tickers.join(', ')}` : ''}
            </p>
            <span class="badge ${badgeClass} mb-2 text-uppercase">${stance}</span>
            <p class="mb-2">${analysis.summary || ''}</p>
            <h6 class="mt-3">Why this matters</h6>
            <ul class="mb-2">${rationaleList}</ul>
            <p class="small text-muted mb-0">${analysis.risk_notes || ''}</p>
            <p class="small text-muted mt-1">${analysis.disclaimer || ''}</p>
        `;
    }

    if (newsRefreshBtn) {
        newsRefreshBtn.addEventListener('click', fetchNewsHeadlines);
    }

    // SCANNER FUNCTIONS
    async function fetchData() {
        runScanBtn.textContent = 'Scanning...';
        runScanBtn.disabled = true;

        try {
            const response = await fetch('/api/scan', { method: 'POST' });
            const result = await response.json();

            if (result.success) {
                allAlertData = result;
                displayAlerts(result);
                lastUpdated.textContent = `Last Scan: ${new Date().toLocaleTimeString()}`;
            } else {
                console.error("API Error:", result.error);
                alert(`Scanner Failed: ${result.error}`);
            }
        } catch (error) {
            console.error('Fetch Error:', error);
            alert('A network or server error occurred. Check connection.');
        } finally {
            runScanBtn.textContent = 'Run Scanner';
            runScanBtn.disabled = false;
        }
    }

    function displayAlerts(fullResult) {
        const data = fullResult.data;
        MARKET_CAPS.forEach(cap => {
            const tableBody = document.getElementById(`${cap}-table`);
            tableBody.innerHTML = '';
            const alerts = data[cap] || [];

            if (alerts.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="3" class="text-center text-muted">
                            No high-probability setups detected.
                        </td>
                    </tr>`;
                return;
            }

            alerts.forEach(alert => {
                const row = document.createElement('tr');
                row.className = 'alert-row';
                row.setAttribute('data-cap', cap);
                row.setAttribute('data-ticker', alert.Ticker);

                row.onclick = function() {
                    if (currentActiveRow) {
                        currentActiveRow.classList.remove('active');
                    }
                    this.classList.add('active');
                    currentActiveRow = this;
                    showAnalysisCard(cap, alert.Ticker);
                };

                row.innerHTML = `
                    <td>
                        <strong class="text-ticker">${alert.Ticker}</strong>
                        <span class="badge ${
                            alert.PrimaryCatalyst &&
                            (alert.PrimaryCatalyst.toLowerCase().includes('sec filing') ||
                             alert.PrimaryCatalyst.toLowerCase().includes('news'))
                            ? 'bg-danger'
                            : 'bg-info'
                        }">
                            ${alert.PrimaryCatalyst ? 'CATALYST' : 'TECH'}
                        </span>
                    </td>
                    <td>$${parseFloat(alert.EntryPrice).toFixed(2)}</td>
                    <td>
                        <strong class="text-gain-percent">
                            +${parseFloat(alert.PotentialGainPercent).toFixed(2)}%
                        </strong>
                        <span class="text-muted small">
                            @$${parseFloat(alert.TargetPrice).toFixed(2)}
                        </span>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        });

        const firstCap = MARKET_CAPS.find(cap => data[cap] && data[cap].length > 0);
        if (firstCap && data[firstCap].length > 0) {
            const firstRow = document.querySelector(`#${firstCap}-table tr`);
            if (firstRow) firstRow.click();
        }
    }

    function showAnalysisCard(cap, ticker) {
        const analysisDiv = document.getElementById('detailedAnalysisCard');
        const alertData = allAlertData.data[cap];
        if (!alertData) return;

        const alert = alertData.find(a => a.Ticker === ticker);
        if (!alert) {
            analysisDiv.innerHTML = `
                <p class="text-center p-4 text-muted mb-0">
                    Analysis data not found.
                </p>`;
            return;
        }

        const analysisPoints = alert.DetailedAnalysis.split('\n')
            .filter(item => item.trim().startsWith('*'))
            .map(item => `<li>${item.trim().substring(1).trim()}</li>`)
            .join('');

        analysisDiv.innerHTML = `
            <div class="card-header bg-dark text-white p-3">
                <h4 class="mb-0 text-info">
                    ${alert.Ticker} - Trading Thesis & Action Plan
                </h4>
            </div>
            <div class="card-body p-4">
                <div class="row">
                    <div class="col-md-6 border-end border-secondary">
                        <h5>
                            Trade Setup & Thesis
                            <span class="badge bg-warning text-dark">WHY NOW?</span>
                        </h5>
                        <ul class="list-unstyled">${analysisPoints}</ul>
                        <p class="mt-3">
                            <strong>Primary Catalyst:</strong>
                            <span class="text-light">${alert.PrimaryCatalyst}</span>
                        </p>
                    </div>
                    <div class="col-md-6">
                        <h5>
                            Actionable Strategy
                            <span class="badge bg-primary">THE PLAN</span>
                        </h5>
                        <p class="mb-1">
                            <strong>Entry Trigger:</strong>
                            <span class="text-success fs-5">
                                $${parseFloat(alert.EntryPrice).toFixed(2)}
                            </span>
                        </p>
                        <p class="mb-1">
                            <strong>Target Profit (Exit):</strong>
                            <span class="text-info fs-5">
                                $${parseFloat(alert.TargetPrice).toFixed(2)}
                            </span>
                        </p>
                        <p class="mb-1">
                            <strong>Potential Gain:</strong>
                            <span class="text-gain-percent fs-4">
                                ${parseFloat(alert.PotentialGainPercent).toFixed(2)}%
                            </span>
                        </p>
                        <p class="mb-1">
                            <strong>Maximum Stop Loss:</strong>
                            <span class="text-danger fs-5">
                                $${parseFloat(alert.StopPrice).toFixed(2)}
                            </span>
                        </p>
                        <small class="text-muted">
                            Tier: ${cap}. Calculated Risk/Reward is implicitly based on these levels.
                        </small>
                    </div>
                </div>
            </div>
        `;
    }

    runScanBtn.addEventListener('click', fetchData);

    // load news on page open
    fetchNewsHeadlines();
</script>
</body>
</html>
